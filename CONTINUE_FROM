Nested scopes and name resolution